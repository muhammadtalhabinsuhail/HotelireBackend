generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model role {
  roleid     Int       @id @default(autoincrement())
  rolename   String    @unique @db.VarChar(100)
  created_at DateTime? @default(now()) @db.Timestamp(6)
  User       User[]
}

model states {
  id         Int    @id @default(autoincrement())
  name       String @db.VarChar(255)
  country_id Int
}

model User {
  userid                 Int                   @id @default(autoincrement())
  roleid                 Int?                  @default(3)
  firstname              String                @db.VarChar(50)
  lastname               String                @db.VarChar(50)
  email                  String                @unique @db.VarChar(100)
  passwordhash           String?               @db.VarChar(255)
  address                String?               @db.VarChar(200)
  canadian_provinceid    Int?
  canadian_cityid        Int?
  international_country  String?               @db.VarChar(100)
  international_province String?               @db.VarChar(100)
  international_city     String?               @db.VarChar(100)
  postalcode             String?               @db.VarChar(20)
  phoneno                String?               @db.VarChar(20)
  isemailverified        Boolean?              @default(false)
  profilepic             String?
  createdat              DateTime?             @default(now()) @db.Timestamp(6)
  updatedat              DateTime?             @default(now()) @db.Timestamp(6)
  isGoogleUser           Boolean?              @default(false)
  canadian_cities        canadian_cities?      @relation(fields: [canadian_cityid], references: [canadian_city_id], onDelete: NoAction, onUpdate: NoAction)
  canadian_states        canadian_states?      @relation(fields: [canadian_provinceid], references: [canadian_province_id], onDelete: NoAction, onUpdate: NoAction)
  role                   role?                 @relation(fields: [roleid], references: [roleid], onDelete: NoAction, onUpdate: NoAction)
  booking                booking[]
  owner_subscriptions    owner_subscriptions[]
  ownerinfo              ownerinfo?
  property               property[]
  review                 review[]
}

model canadian_cities {
  canadian_city_id     Int             @id @default(autoincrement())
  canadian_city_name   String          @db.VarChar(100)
  canadian_province_id Int
  User                 User[]
  canadian_states      canadian_states @relation(fields: [canadian_province_id], references: [canadian_province_id], onDelete: NoAction, onUpdate: NoAction)
  property             property[]

  @@unique([canadian_city_name, canadian_province_id], map: "unique_city_per_province")
}

model canadian_states {
  canadian_province_id   Int               @id @default(autoincrement())
  canadian_province_name String            @unique(map: "unique_canadian_province_name") @db.VarChar(100)
  User                   User[]
  canadian_cities        canadian_cities[]
  property               property[]
}

model ownerinfo {
  ownerid                     Int                          @id @default(autoincrement())
  legalfullname               String                       @db.VarChar(50)
  displayname                 String?                      @db.VarChar(50)
  pictypeid                   Int?
  iddocpic                    String?                      @db.VarChar(255)
  pdftypeid                   Int?
  residentialdocpdf           String?                      @db.VarChar(255)
  userid                      Int?                         @unique
  stripe_customer_id          String?                      @db.VarChar(255)
  stripe_connect_id           String?                      @db.VarChar(255)
  payout_schedule             String?                      @default("monthly") @db.VarChar(50)
  minimum_payout_amount       Decimal?                     @default(10) @db.Decimal(10, 2)
  updated_at                  DateTime?                    @default(now()) @db.Timestamptz(6)
  subscription_status         String?                      @db.VarChar(100)
  subscription_id             String?                      @db.VarChar(100)
  current_period_end          DateTime?                    @default(now()) @db.Timestamptz(6)
  owner_subscriptions         owner_subscriptions[]
  owner_residentialdocpdftype owner_residentialdocpdftype? @relation(fields: [pdftypeid], references: [pdftypeid], onDelete: NoAction, onUpdate: NoAction)
  owner_iddocpictype          owner_iddocpictype?          @relation(fields: [pictypeid], references: [pictypeid], onDelete: NoAction, onUpdate: NoAction)
  User                        User?                        @relation(fields: [userid], references: [userid], onDelete: Cascade, onUpdate: NoAction)
}

model owner_iddocpictype {
  pictypeid  Int         @id @default(autoincrement())
  pictype    String      @unique @db.VarChar(100)
  created_at DateTime?   @default(now()) @db.Timestamp(6)
  ownerinfo  ownerinfo[]
}

model owner_residentialdocpdftype {
  pdftypeid  Int         @id @default(autoincrement())
  pdftype    String      @unique @db.VarChar(100)
  created_at DateTime?   @default(now()) @db.Timestamp(6)
  ownerinfo  ownerinfo[]
  property   property[]
}

model amenities {
  amenitiesid       Int                 @id @default(autoincrement())
  amenitiesname     String?             @db.VarChar(255)
  icons             String?             @db.VarChar(80)
  propertyamenities propertyamenities[]
}

model property {
  propertyid                  Int                          @id @default(autoincrement())
  propertylocationid          Int?
  canadian_province_id        Int?
  canadian_city_id            Int?
  address                     String?                      @db.VarChar(200)
  postalcode                  String?                      @db.VarChar(20)
  pdftypeid                   Int?
  residentialdocpdf           String?                      @db.VarChar(255)
  propertyclassificationid    Int?
  propertytitle               String?                      @db.VarChar(255)
  propertysubtitle            String?                      @db.VarChar(255)
  propertymaplink             String?
  photo1_featured             String?
  photo2                      String?
  photo3                      String?
  photo4                      String?
  photo5                      String?
  checkintime                 String?                      @db.VarChar(50)
  checkouttime                String?                      @db.VarChar(50)
  houserules                  String?
  issuspended                 Boolean?                     @default(false)
  userid                      Int?
  AvailableStatus             Boolean?                     @default(false)
  created_at                  DateTime?                    @default(now()) @db.Timestamp(6)
  is_active                   Boolean?                     @default(true)
  is_active_byConnectId       Boolean?                     @default(false)
  booking                     booking[]
  canadian_cities             canadian_cities?             @relation(fields: [canadian_city_id], references: [canadian_city_id], onDelete: NoAction, onUpdate: NoAction)
  canadian_states             canadian_states?             @relation(fields: [canadian_province_id], references: [canadian_province_id], onDelete: NoAction, onUpdate: NoAction)
  owner_residentialdocpdftype owner_residentialdocpdftype? @relation(fields: [pdftypeid], references: [pdftypeid], onDelete: NoAction, onUpdate: NoAction)
  propertyclassification      propertyclassification?      @relation(fields: [propertyclassificationid], references: [propertyclassificationid], onDelete: NoAction, onUpdate: NoAction)
  propertylocation            propertylocation?            @relation(fields: [propertylocationid], references: [propertylocationid], onDelete: NoAction, onUpdate: NoAction)
  User                        User?                        @relation(fields: [userid], references: [userid], onDelete: Cascade, onUpdate: NoAction)
  propertyamenities           propertyamenities[]
  propertyroom                propertyroom[]
  propertysafetyfeatures      propertysafetyfeatures[]
  propertysharedspaces        propertysharedspaces[]
  review                      review[]
}

model propertyamenities {
  propertyamenitiesid Int        @id @default(autoincrement())
  amenitiesid         Int?
  propertyid          Int?
  features            Boolean?   @default(false)
  amenities           amenities? @relation(fields: [amenitiesid], references: [amenitiesid], onDelete: NoAction, onUpdate: NoAction)
  property            property?  @relation(fields: [propertyid], references: [propertyid], onDelete: Cascade, onUpdate: NoAction)
}

model propertyclassification {
  propertyclassificationid   Int        @id @default(autoincrement())
  propertyclassificationname String?    @db.VarChar(255)
  property                   property[]
}

model propertylocation {
  propertylocationid   Int        @id @default(autoincrement())
  propertylocationname String?    @db.VarChar(255)
  property             property[]
}

model propertyroom {
  propertyroomid      Int                   @id @default(autoincrement())
  propertyid          Int?
  roomtypeid          Int?
  roomname            String?               @db.VarChar(255)
  roomcount           Int?
  price               Decimal?              @db.Decimal(10, 2)
  available           Boolean?              @default(true)
  pic1                String?
  pic2                String?
  booking_room        booking_room[]
  owner_subscriptions owner_subscriptions[]
  property            property?             @relation(fields: [propertyid], references: [propertyid], onDelete: Cascade, onUpdate: NoAction)
  roomtype            roomtype?             @relation(fields: [roomtypeid], references: [roomtypeid], onDelete: NoAction, onUpdate: NoAction)
  room_availability   room_availability[]
}

model propertysafetyfeatures {
  propertysafetyfeaturesid Int             @id @default(autoincrement())
  safetyfeaturesid         Int?
  propertyid               Int?
  property                 property?       @relation(fields: [propertyid], references: [propertyid], onDelete: Cascade, onUpdate: NoAction)
  safetyfeatures           safetyfeatures? @relation(fields: [safetyfeaturesid], references: [safetyfeaturesid], onDelete: NoAction, onUpdate: NoAction)
}

model propertysharedspaces {
  propertysharedspacesid Int           @id @default(autoincrement())
  sharedspacesid         Int?
  propertyid             Int?
  property               property?     @relation(fields: [propertyid], references: [propertyid], onDelete: Cascade, onUpdate: NoAction)
  sharedspaces           sharedspaces? @relation(fields: [sharedspacesid], references: [sharedspacesid], onDelete: NoAction, onUpdate: NoAction)
}

model roomtype {
  roomtypeid   Int            @id @default(autoincrement())
  roomtypename String?        @db.VarChar(255)
  propertyroom propertyroom[]
}

model safetyfeatures {
  safetyfeaturesid       Int                      @id @default(autoincrement())
  safetyfeaturesname     String?                  @db.VarChar(255)
  icons                  String?                  @db.VarChar(80)
  propertysafetyfeatures propertysafetyfeatures[]
}

model sharedspaces {
  sharedspacesid       Int                    @id @default(autoincrement())
  sharedspacesname     String?                @db.VarChar(255)
  icons                String?                @db.VarChar(80)
  propertysharedspaces propertysharedspaces[]
}

model booking {
  bookingid         Int                 @id @default(autoincrement())
  userid            Int?
  propertyid        Int?
  checkin_date      DateTime            @db.Date
  checkout_date     DateTime            @db.Date
  adults            Int?                @default(1)
  children          Int?                @default(0)
  total_guests      Int?                @default(dbgenerated("(adults + children)"))
  total_nights      Int
  total_amount      Decimal             @db.Decimal(10, 2)
  booking_status    String?             @default("PENDING") @db.VarChar(30)
  created_at        DateTime?           @default(now()) @db.Timestamp(6)
  updated_at        DateTime?           @default(now()) @db.Timestamp(6)
  property          property?           @relation(fields: [propertyid], references: [propertyid], onDelete: Cascade, onUpdate: NoAction)
  User              User?               @relation(fields: [userid], references: [userid], onDelete: Cascade, onUpdate: NoAction)
  booking_room      booking_room[]
  payment           payment[]
  review            review?
  room_availability room_availability[]
}

model booking_room {
  bookingroomid  Int           @id @default(autoincrement())
  bookingid      Int?
  propertyroomid Int?
  room_price     Decimal       @db.Decimal(10, 2)
  room_count     Int
  subtotal       Decimal       @db.Decimal(10, 2)
  booking        booking?      @relation(fields: [bookingid], references: [bookingid], onDelete: Cascade, onUpdate: NoAction)
  propertyroom   propertyroom? @relation(fields: [propertyroomid], references: [propertyroomid], onDelete: Cascade, onUpdate: NoAction)
}

model payment {
  paymentid                  Int             @id @default(autoincrement())
  bookingid                  Int?
  paymentmethodid            Int?
  amount                     Decimal         @db.Decimal(10, 2)
  currency                   String?         @default("USD") @db.VarChar(10)
  stripe_payment_intent_id   String?         @db.VarChar(255)
  stripe_charge_id           String?         @db.VarChar(255)
  payment_status             String?         @default("PENDING") @db.VarChar(30)
  paid_at                    DateTime?       @db.Timestamp(6)
  created_at                 DateTime?       @default(now()) @db.Timestamp(6)
  stripe_connect_transfer_id String?         @db.VarChar(255)
  application_fee_amount     Decimal?        @db.Decimal(10, 2)
  booking                    booking?        @relation(fields: [bookingid], references: [bookingid], onDelete: Cascade, onUpdate: NoAction)
  payment_method             payment_method? @relation(fields: [paymentmethodid], references: [paymentmethodid], onDelete: NoAction, onUpdate: NoAction)
}

model payment_method {
  paymentmethodid Int       @id @default(autoincrement())
  method_name     String?   @unique @db.VarChar(50)
  payment         payment[]
}

model room_availability {
  availabilityid Int           @id @default(autoincrement())
  bookingid      Int?
  propertyroomid Int?
  booked_date    DateTime      @db.Date
  rooms_booked   Int
  created_at     DateTime?     @default(now()) @db.Timestamp(6)
  booking        booking?      @relation(fields: [bookingid], references: [bookingid], onDelete: Cascade, onUpdate: NoAction)
  propertyroom   propertyroom? @relation(fields: [propertyroomid], references: [propertyroomid], onDelete: Cascade, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model review {
  id               Int       @id @default(autoincrement())
  booking_id       Int       @unique
  property_id      Int
  user_id          Int
  rating           Int?
  comment          String?
  is_public        Boolean?  @default(true)
  created_at       DateTime? @default(now()) @db.Timestamp(6)
  updated_at       DateTime? @default(now()) @db.Timestamp(6)
  review_requested Boolean?  @default(false)
  review_submitted Boolean?  @default(false)
  booking          booking   @relation(fields: [booking_id], references: [bookingid], onDelete: Cascade, onUpdate: NoAction)
  property         property  @relation(fields: [property_id], references: [propertyid], onDelete: Cascade, onUpdate: NoAction)
  User             User      @relation(fields: [user_id], references: [userid], onDelete: Cascade, onUpdate: NoAction)
}

model owner_subscriptions {
  id                   Int           @id @default(autoincrement())
  userid               Int?
  ownerid              Int?
  propertyroomid       Int?
  amount               Decimal?      @db.Decimal(10, 2)
  currency             String        @default("CAD") @db.VarChar(10)
  current_period_start DateTime?     @db.Timestamp(6)
  current_period_end   DateTime?     @db.Timestamp(6)
  created_at           DateTime?     @default(now()) @db.Timestamp(6)
  ownerinfo            ownerinfo?    @relation(fields: [ownerid], references: [ownerid], onDelete: Cascade, onUpdate: NoAction, map: "fk_owner_subscriptions_owner")
  propertyroom         propertyroom? @relation(fields: [propertyroomid], references: [propertyroomid], onDelete: Cascade, onUpdate: NoAction, map: "fk_owner_subscriptions_propertyroom")
  User                 User?         @relation(fields: [userid], references: [userid], onDelete: Cascade, onUpdate: NoAction, map: "fk_owner_subscriptions_user")
}
